{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///Users/corporationoprimed/Desktop/apps/nexus-fe-grafy/src/app/api/proxy/download/%5BtaskId%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\n\r\nconst API_BASE_URL =\r\n  process.env.NEXT_PUBLIC_API_BASE_URL ?? \"https://nexus.oprimed.com\";\r\n\r\nexport async function GET(\n  _request: NextRequest,\n  { params }: { params: Promise<{ taskId: string }> }\n) {\n  try {\n    const now = new Date();\n    const year = now.getFullYear();\n    const month = String(now.getMonth() + 1).padStart(2, \"0\");\n    const day = String(now.getDate()).padStart(2, \"0\");\n    const reportFileName = `${year}-${month}-${day}_OPTIVIS Nexus_ATS_Report.pdf`;\n\n    const { taskId } = await params;\n\r\n    const response = await fetch(\r\n      `${API_BASE_URL}/api/nexus/files/download/${taskId}/`,\r\n      {\r\n        method: \"GET\",\r\n        headers: {\r\n          accept: \"application/json\",\r\n        },\r\n      }\r\n    );\r\n\r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      return NextResponse.json(\r\n        { error: errorText },\r\n        { status: response.status }\r\n      );\r\n    }\r\n\r\n    const blob = await response.blob();\r\n    const encodedFileName = encodeURIComponent(reportFileName);\n\n    return new NextResponse(blob, {\n      headers: {\n        \"Content-Type\": \"application/pdf\",\n        \"Content-Disposition\": `attachment; filename=\"${reportFileName}\"; filename*=UTF-8''${encodedFileName}`,\n        \"X-Content-Type-Options\": \"nosniff\",\n      },\n    });\n  } catch (error) {\r\n    return NextResponse.json(\r\n      { error: error instanceof Error ? error.message : \"Proxy request failed\" },\r\n      { status: 502 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,eACJ,QAAQ,GAAG,CAAC,wBAAwB,IAAI;AAEnC,eAAe,IACpB,QAAqB,EACrB,EAAE,MAAM,EAA2C;IAEnD,IAAI;QACF,MAAM,MAAM,IAAI;QAChB,MAAM,OAAO,IAAI,WAAW;QAC5B,MAAM,QAAQ,OAAO,IAAI,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG;QACrD,MAAM,MAAM,OAAO,IAAI,OAAO,IAAI,QAAQ,CAAC,GAAG;QAC9C,MAAM,iBAAiB,GAAG,KAAK,CAAC,EAAE,MAAM,CAAC,EAAE,IAAI,6BAA6B,CAAC;QAE7E,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM;QAEzB,MAAM,WAAW,MAAM,MACrB,GAAG,aAAa,0BAA0B,EAAE,OAAO,CAAC,CAAC,EACrD;YACE,QAAQ;YACR,SAAS;gBACP,QAAQ;YACV;QACF;QAGF,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,YAAY,MAAM,SAAS,IAAI;YACrC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAU,GACnB;gBAAE,QAAQ,SAAS,MAAM;YAAC;QAE9B;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,MAAM,kBAAkB,mBAAmB;QAE3C,OAAO,IAAI,gJAAY,CAAC,MAAM;YAC5B,SAAS;gBACP,gBAAgB;gBAChB,uBAAuB,CAAC,sBAAsB,EAAE,eAAe,oBAAoB,EAAE,iBAAiB;gBACtG,0BAA0B;YAC5B;QACF;IACF,EAAE,OAAO,OAAO;QACd,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAAuB,GACzE;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}